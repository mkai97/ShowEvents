<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>æ–‡ç« åˆ—è¡¨</title>
    <link rel="stylesheet" href="js/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/iconfont.css">
    <link rel="stylesheet" href="css/main.css">
    <script src="js/jquery-1.12.4.min.js"></script>
    <script src="js/bootstrap/js/bootstrap.min.js"></script>
</head>

<body>
    <div class="container-fluid">
        <div class="common_title">
            æ–‡ç« ç±»åˆ«ç®¡ç†
        </div>
        <div class="container-fluid common_con">
            <table class="table table-striped table-bordered table-hover mp20 category_table">
                <thead>
                    <tr>
                        <th>åç§°</th>
                        <th>Slug</th>
                        <th class="text-center" width="100">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="tb">
                    <!-- <tr>
                        <td>æœªåˆ†ç±»</td>
                        <td>uncategorized</td>
                        <td class="text-center">
                            <a href="javascript:editTr({&quot;id&quot;:&quot;1&quot;,&quot;slug&quot;:&quot;uncategorized&quot;,&quot;name&quot;:&quot;æœªåˆ†ç±»&quot;});" class="btn btn-info btn-xs">ç¼–è¾‘</a>
                            <a href="javascript:deleteTr( 1 );" class="btn btn-danger btn-xs">åˆ é™¤</a>
                        </td>
                    </tr>

                    <tr>
                        <td>å¥‡è¶£äº‹</td>
                        <td>funny</td>
                        <td class="text-center">
                            <a href="javascript:editTr({&quot;id&quot;:&quot;2&quot;,&quot;slug&quot;:&quot;funny&quot;,&quot;name&quot;:&quot;å¥‡è¶£äº‹&quot;});" class="btn btn-info btn-xs">ç¼–è¾‘</a>
                            <a href="javascript:deleteTr( 2 );" class="btn btn-danger btn-xs">åˆ é™¤</a>
                        </td>
                    </tr>

                    <tr>
                        <td>ä¼šç”Ÿæ´»</td>
                        <td>living</td>
                        <td class="text-center">
                            <a href="javascript:editTr({&quot;id&quot;:&quot;3&quot;,&quot;slug&quot;:&quot;living&quot;,&quot;name&quot;:&quot;ä¼šç”Ÿæ´»&quot;});" class="btn btn-info btn-xs">ç¼–è¾‘</a>
                            <a href="javascript:deleteTr( 3 );" class="btn btn-danger btn-xs">åˆ é™¤</a>
                        </td>
                    </tr>

                    <tr>
                        <td>çˆ±æ—…è¡Œ</td>
                        <td>travel</td>
                        <td class="text-center">
                            <a href="javascript:editTr({&quot;id&quot;:&quot;4&quot;,&quot;slug&quot;:&quot;travel&quot;,&quot;name&quot;:&quot;çˆ±æ—…è¡Œ&quot;});" class="btn btn-info btn-xs">ç¼–è¾‘</a>
                            <a href="javascript:deleteTr( 4 );" class="btn btn-danger btn-xs">åˆ é™¤</a>
                        </td>
                    </tr> -->
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" class="text-center">
                            <a href="#" class="btn btn-success" data-toggle="modal" data-target="#addModal">æ–°å¢åˆ†ç±»</a>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <div class="modal fade" id="addModal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                    <h4 class="modal-title">æ–°å¢åˆ†ç±»</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="recipient-name" class="control-label">åˆ†ç±»åç§°:</label>
                            <input type="text" class="form-control" id="recipient-name">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="control-label">åˆ†ç±»åˆ«å:</label>
                            <input type="text" class="form-control" id="recipient-name">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="model_shutoff">å…³é—­</button>
                    <button type="button" class="btn btn-primary" id="model_add">æ–°å¢</button>
                </div>
            </div>
        </div>
    </div>
    <div id="myModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">ç³»ç»Ÿæç¤º</h4>
                </div>
                <div class="modal-body">
                    <p id="modalMsg">çœŸçš„è¦åˆ é™¤ä¹ˆ???ğŸ˜€</p>
                </div>
                <div class="modal-footer">
                    <button type="button" id="close" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button id="btnok" type="button" class="btn btn-primary">ok</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
    <script src="./js/template-web.js"></script>
    <script>
        $('#addModal').modal({
            show: false,
            backdrop: false
        });

        $('#model_shutoff').click(function() {
            alert('shutoff');
            $('#addModal').modal('hide');
        });

        $('#model_add').click(function() {
            alert('add');
            $('#addModal').modal('hide');
        });

        $('.category_table').delegate('a', 'click', function() {
            if ($(this).hasClass('btn-info')) {
                $('#addModal .modal-title').html('ä¿®æ”¹åˆ†ç±»åç§°');
                $('#addModal').modal('show');
            }
        })
    </script>
    <script type="text/html" id="cate">

        {{each data item}}
        <tr>


            <td>{{item.name}} </td>

            <td>{{item.slug}}</td>


            <td class="text-center">
                <a href="javascript:editTr({{item.slug}} {{item.slug}});" class="btn btn-info btn-xs">ç¼–è¾‘</a>
                <a href="javascript:deleteTr({{item.id}});" class="btn btn-danger btn-xs">åˆ é™¤</a>
            </td>
        </tr>
        {{/each}}
    </script>
    <script>
        function getlist() {
            $.ajax({
                type: "GET", //é»˜è®¤get
                url: "http://localhost:8000/admin/category_search", //é»˜è®¤å½“å‰é¡µ
                data: "", //æ ¼å¼{key:value}
                dataType: "json",
                beforeSend: function() {}, //è¯·æ±‚å‘é€å‰å›è°ƒ,å¸¸ç”¨éªŒè¯
                success: function(response) { //è¯·æ±‚æˆåŠŸå›è°ƒ
                    if (response.code === 200) {
                        console.log(response);
                        var res = response;
                        var html = template("cate", res);
                    }
                    document.getElementById("tb").innerHTML = html;
                },
                error: function(e) { //è¯·æ±‚è¶…æ—¶å›è°ƒ
                    if (e.statusText == "timeout") {
                        alert("è¯·æ±‚è¶…æ—¶");
                    }
                },
                complete: function() {}, //æ— è®ºè¯·æ±‚æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½ä¼šæ‰§è¡Œçš„å›è°ƒï¼Œå¸¸ç”¨å…¨å±€æˆå‘˜çš„é‡Šæ”¾ï¼Œæˆ–è€…é¡µé¢çŠ¶æ€çš„é‡ç½®
            });
        };
        getlist();

        function deleteTr(id) {
            $('#myModal').modal('show');
            $('#btnok').click(function() {
                $.ajax({
                    type: "POST", //é»˜è®¤get
                    url: "http://localhost:8000/admin/category_delete", //é»˜è®¤å½“å‰é¡µ
                    data: {
                        "id": id
                    }, //æ ¼å¼{key:value}
                    dataType: "json",
                    beforeSend: function() {}, //è¯·æ±‚å‘é€å‰å›è°ƒ,å¸¸ç”¨éªŒè¯
                    success: function(response) { //è¯·æ±‚æˆåŠŸå›è°ƒ
                        console.log(response);
                    },
                    error: function(e) { //è¯·æ±‚è¶…æ—¶å›è°ƒ
                        if (e.statusText == "timeout") {
                            alert("è¯·æ±‚è¶…æ—¶");
                        }
                    },
                    complete: function() {}, //æ— è®ºè¯·æ±‚æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½ä¼šæ‰§è¡Œçš„å›è°ƒï¼Œå¸¸ç”¨å…¨å±€æˆå‘˜çš„é‡Šæ”¾ï¼Œæˆ–è€…é¡µé¢çŠ¶æ€çš„é‡ç½®
                });
                $('#myModal').modal('hide');
                getlist();

            })

        }
    </script>

</body>

</html>